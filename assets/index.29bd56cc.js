import{l as e}from"./vendor.c6dfbf97.js";function t(e,t){const n={vnode:!0};return n.type=e,n.props=t||{},n.children=[].concat.apply([],[].slice.call(arguments,2)),n.isInstance=e&&e.template&&"function"==typeof e.template,n.isComponent="function"==typeof e&&e.prototype&&"function"==typeof e.prototype.render,n.isStateless="function"==typeof e&&!n.isComponent,n.isDom="string"==typeof e,n}function n(e,t){for(const n in t)e[n]=t[n];return e}function s(){}t.f=e=>e.children;const r={log:s,warn:s,error:s};let i=()=>r;i=function(e,t,n,s){if(s)return r;const i=[];e=e.toUpperCase(),i.push("%c%s");let o="font-weight:bold; line-height: 1.2em;";return t&&(o+=`color:${t};`),n&&(o+=`background-color:${n};`),o+="border-radius: 4px;padding: 1px 6px 0;",i.push(o),i.push(e),{log:console.log.bind(console,...i),warn:console.warn.bind(console,...i),error:console.error.bind(console,...i)}};var o=i;const a=["nodes","components","refs","pendingListeners","listeners"];class l{constructor(){this.data={};for(let e=0;e<a.length;e++)this.data[a[e]]=[]}append(e){for(const t in e)this.data[t]=this.data[t].concat(e[t])}set(e){for(const t in e)this.data[t]=e[t]}get(){return this.data}}const c=[],h="http://www.w3.org/1999/xlink",u=["xlink","xmlns","xml"],d=["placeholder","webkit-playsinline","playsinline","for","selected","list","tagName","type","form","size","download","href"].reduce(((e,t)=>(e[t]=!0,e)),{}),f=(e,t)=>e.substr(0,t.length)===t,p=e=>(t,n)=>n.classList.toggle(e,t||!1),m=function(e,t="textContent",n){const s=t!==(t=t.replace(/^xlink:?/,"")),r=!!/^ar/.test(t),i=f(t,"data-"),o=r||n||d[t]||i,a=t in e&&!o;return s?(t=t.toLowerCase(),function(e,n){null==e||!1===e?n.removeAttributeNS(h,t):n.setAttributeNS(h,t,e)}):a?function(e,n){n[t]=null==e?"":e}:function(e,n){null==e||!1===e&&r?n.removeAttribute(t):n.setAttribute(t,e)}};function g(e,t,s,r,i){if(void 0!==s&&"__self"!==t&&"__source"!==t&&"ref"!==t){"className"===t&&(t="class"),"text"===t&&(t="textContent");for(let e=0;e<u.length;e++)if(f(t,u[e])){const n=u[e].length;t[n]&&":"!==t[n]&&(t=u[e]+":"+t[n].toLowerCase()+t.substr(n+1,t.length));break}if("o"===t[0]&&"n"===t[1]){let n=t;const i=n!==(n=n.replace(/Capture$/,"")),o=n.toLowerCase();o in e&&(n=o),n=n.slice(2),r.append({pendingListeners:[{type:"dom",el:e,evt:n,fn:s,capture:i}]})}else if("store"===t){const t=Array.isArray(s)?s:[s],n=[];for(let s=0,r=t.length;s<r;s++){const r=Array.isArray(t[s])?t[s]:[t[s]],i=r[0],o=r[1],a=void 0===r[2]||r[2];i&&n.push({type:"store",store:i,fn:o,init:a,el:e})}r.append({pendingListeners:n})}else if(s&&s._isStoreSignal){let n=!1;const o=t;f(o,"class-")&&(n=p(o.substring(6))),n||(n=m(e,o,i)),r.append({pendingListeners:[{type:"store",store:s,fn:n,el:e,init:!0}]})}else if("class"!==t||i){if("style"===t)"object"==typeof s?n(e.style,s):"string"==typeof s&&(e.style.cssText=s);else if("object"!=typeof s&&"function"!=typeof s)try{m(e,t,i)(s,e)}catch(o){}}else if("string"==typeof s)e.className=s||"";else if("object"==typeof s){c.length=0;for(const t in s){const n=s[t];n&&(n._isStoreSignal?r.append({pendingListeners:[{type:"store",store:n,fn:p(t),el:e,init:!0}]}):c.push(t))}c.length>0&&(e.className=c.join(" "))}}}function w(e,t){if(Array.isArray(e))return function(e,t){n=e,e=Array.isArray(n)?n:[n];var n;const s=new l;for(let r=0;r<e.length;r++)s.append(w(e[r],t));return s.get()}(e,t);if(e instanceof window.Element||e instanceof window.Comment)return function(e){const t=new l;return t.append({nodes:e}),t.get()}(e);if(null===e||"object"!=typeof e||!e.vnode)return function(e){const t=new l;return null==e||!1===e||t.append({nodes:document.createTextNode(e+"")}),t.get()}(e);const s=n(n({},e.props),{children:[].concat.apply([],e.children||[])});return e.isDom?function(e,t,n){const s=new l;let r=[];"svg"===e.type&&(n=!0);for(let o=0;o<t.children.length;o++){const e=w(t.children[o],n);e.nodes&&(r=r.concat(e.nodes),s.append({components:e.components,refs:e.refs,pendingListeners:e.pendingListeners,listeners:e.listeners}))}const i=n?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type);for(const o in e.props)g(i,o,e.props[o],s,n);for(let o=0;o<r.length;o++)i.appendChild(r[o]);t.ref&&s.append({refs:{ref:i,fn:t.ref}});return s.append({nodes:i}),s.get()}(e,s,t):e.isInstance?b(e,s,t,!0):e.isStateless?function(e,t,n){const s=new l,r=e.type(t);return s.append(w(r,n)),s.get()}(e,s,t):e.isComponent?b(e,s,t):void 0}function b(e,t,n,s=!1){const r=new l,i=s?e.type:new e.type(t);i.beforeRender(i.props,i.state);const o=i.template(i.props,i.state);t.ref&&r.append({refs:{ref:i,fn:t.ref}}),r.append(w(o,n));const a=r.data.nodes;i.base=a.length>1?a:a[0];for(const l in r.data)"nodes"!==l&&(i._collector[l]||(i._collector[l]=[]),i._collector[l]=i._collector[l].concat(r.data[l]));r.set({components:[i],refs:[],pendingListeners:[],listeners:[]});for(let l=0;l<i._collector.components.length;l++)i._collector.components[l]._parent=i;return r.get()}function v(e,t,n){const s=e._collector&&e._collector.components;if(n&&t(e),s)for(let r=0;r<s.length;r++)v(s[r],t);n||t(e)}function y(e){for(let t=0;t<e._collector.refs.length;t++)e._collector.refs[t].fn(e._collector.refs[t].ref),e._collector.refs[t].ref=null}function x(e){for(let t=e._collector.pendingListeners.length-1;t>=0;t--){const n=e._collector.pendingListeners.splice(t,1)[0];if(e._collector.listeners.push(n),"dom"===n.type)n.el.addEventListener(n.evt,n.fn,n.capture);else if("store"===n.type){const e=n.fn;n.fn=function(t){e(t,n.el)},n.store.subscribe(n.fn),n.init&&n.fn(n.store.current)}}}function S(e){v(e,x)}let P=0;function C(e,t,n){P++;let s=0;const r=w(e,t&&("SVG"===t.tagName||t instanceof SVGElement));let i={_collector:r};if(v(i,y),v(i,(function(e){e.afterRender&&e.afterRender(e.props,e.state)})),"function"==typeof t){t(r.nodes.length<2?r.nodes[0]:r.nodes)}else if(t)for(s=0;s<r.nodes.length;s++)t.appendChild(r.nodes[s]);if(!n||n.mounted){let e=P,t=0;for(S(i);e!==P;){if(++t>10){console.warn("Too many re-rendering from store- attributes");break}e=P,S(i)}v(i,(function(e){e.mounted=!0,e.afterMount&&e.afterMount(e.props,e.state)}))}if(n&&n._collector){const e=n._collector;for(s=0;s<r.components.length;s++)r.components[s]._parent=n;e.refs&&(e.refs=e.refs.concat(r.refs)),e.components&&(e.components=e.components.concat(r.components)),e.pendingListeners&&(e.pendingListeners=e.pendingListeners.concat(r.pendingListeners)),e.listeners&&(e.listeners=e.listeners.concat(r.listeners))}return i=void 0,r}let k=null;function A(e){if(null!==k&&(k.property,1)){const e=k;return k=A.prototype=null,e}return k=A.prototype=null==e?Object.create(null):e,new A}for(let dt=0;dt<=10;dt++)A();function _(e,t,n,s){this.fn=t,this.ctx=n||null,this.owner=e,this.once=!!s}function E(e,t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.ctx=t.fn=t.owner=null,t===e._first&&(e._first=t.next),t===e._last&&(e._last=t.prev)}class D{constructor(){this._first=this._last=null,this._isStoreSignal=!0}dispatch(e,t,n,s,r){let i=this._first;for(;i;)i.fn.call(i.ctx,e,t,n,s,r),i.once&&this.unsubscribe(i),i=i.next}subscribe(e,t,n){const s=new _(this,e,t,n);return this._first?(this._last.next=s,s.prev=this._last,this._last=s):(this._first=s,this._last=s),s}subscribeOnce(e,t){return this.subscribe(e,t,!0)}unsubscribe(e,t){if(e instanceof _)return E(this,e);t||(t=null);let n=this._first;for(;n;)n.fn===e&&n.ctx===t&&E(this,n),n=n.next}unsubscribeAll(){let e=this._first;for(this._first=this._last=null;e;)E(this,e),e=e.next}}function M(){return new D}class I extends D{constructor(e){super(),this.current=e}get(){return this.current}}let R=!1;const L=new Set;function z(){R=!0}function O(){R=!1,L.forEach(T),L.clear()}function T(e){e._dispatch()}var N={stack:L,isHold:()=>R,holdStoreDispatches:z,releaseStoreDispatches:O,batchUpdates:function(e){return function(t,n,s){z(),e(t,n,s),O()}}};class F extends I{set(e,t){if(t||this.current!==e){if(this.previous=this.current,this.current=e,N.isHold())return N.stack.add(this);this._dispatch()}}_dispatch(){let e=this._first;for(;e;)e.fn.call(e.ctx,this.current,this.previous),e.once&&this.unsubscribe(e),e=e.next;this.previous=null}update(e,t){const n=e(this.current);this.set(void 0!==n?n:this.current,t)}}function W(e){return new F(e)}function H(e,t){const n=new F,s=n.set.bind(n);delete n.set,e=Array.isArray(e)?e:[e];const r=new Array(e.length);let i=[];for(let a=0,l=e.length;a<l;a++){const t=e[a],n=function(e){r[a]=e,o()};r[a]=t.current,t.subscribe(n),i.push(t,n)}function o(){const e=t.apply(null,r);e&&e.then?e.then(s):s(e)}return n.destroy=function(){for(let e=0,t=i.length;e<t;e+=2)i[e].unsubscribe(i[e+1]);i=null,n.unsubscribeAll()},o(),n}const j=N.holdStoreDispatches,U=N.releaseStoreDispatches,V={tick:M(),triggerResize:M(),screenPixelRatio:W(1),viewportSize:W([10,10]),viewportRatio:W(1),canvasSize:null,initialized:W(!1),sourceName:W(null),sourceWidth:W(10),sourceHeight:W(10),sourceRatio:null,rerender:W(!1),frameDuration:W(30),frameIndex:W(0),framesCount:null,frames:W([]),frame:null,previewData:W(null),keyPressed:W({}),pointerDown:W(!1),panning:!1,grabbing:!1,zoomOffset:W(0),panOffset:W([0,0]),wireframeMode:W(!0),nightMode:W(!!localStorage.getItem("nightmode")),helpVisible:W(!1)};V.nightMode.subscribe((e=>{localStorage.setItem("nightmode",e?1:0)})),V.framesCount=H(V.frames,(e=>e?e.length:0)),V.sourceRatio=H([V.sourceWidth,V.sourceHeight],((e,t)=>e/t)),V.frame=H([V.frameIndex,V.frames],((e,t)=>t[e]||null)),V.canvasSize=H([V.viewportSize,V.sourceRatio],((e,t)=>{const n=e[0],s=e[1],r=n/s,i=.9*(r>t?s*t:n),o=.9*(r>t?s:n*(1/t));return[Math.round(i),Math.round(o)]})),V.panning=H(V.keyPressed,(e=>!!e.SPACE)),V.grabbing=H([V.panning,V.pointerDown],((e,t)=>e&&t)),window.store=V;let B=0;const $=(e,t)=>void 0!==e?e:t,K=new Map,X=new Set(["opacity","transform"]),Q=new Set(["target","ease","duration","delay","willChange"]),Y={outSwift:"cubic-bezier(0.55, 0, 0.1, 1)",snap2:"cubic-bezier(0, 0.975, 0, 1)",bounce:"cubic-bezier(.18, .89, .34, 1.76)",bounce2:"cubic-bezier(0.865, -0.005, 0, 1.47)",hardBounce:"cubic-bezier(0.070, 1.525, 0.360, 0.935)",longKeyframe:"cubic-bezier(.49, .05, .32, 1.04)",elastic:"cubic-bezier(0, .49, .205, 1)"};function q(e,t=1e3,n="linear",s=0){Y[n]&&(n=Y[n]);return`${e} ${t}ms ${Array.isArray(n)?`cubic-bezier(${n.join(",")})`:n} ${s}ms`}function J(e={}){let t=e.complete;const n=!!e.instant,s=!!e.willChange,r=e.target,i={easing:e.easing||"linear",duration:e.duration||1e3,delay:e.delay||0};r.dataset.csstween||(r.dataset.csstween=++B);const o=r.dataset.csstween;let a=null,l=new Promise((e=>a=e));e.queue&&e.queue.push(l);const c={destroy:m,stop:m,finished:l},h=new Set;let u=null,d=!1;return function(){if(d)return{};K.has(o)&&K.get(o).destroy();K.set(o,c);const t=[],a=[],l={},m={};let g=0;for(const s in e){if(Q.has(s))continue;if(void 0===r.style[s])continue;const o=e[s];if(null==o)continue;const c="object"!=typeof o||Array.isArray(o)?{value:o}:o,h=$(c.duration,i.duration),u=$(c.delay,i.delay),d=$(c.easing,i.easing);a.push(q(s,h,d,u)),g=Math.max(g,h+u);const f=Array.isArray(c.value)?c.value:[null,c.value];(n||u<=0&&(!h||h<=0))&&(f[0]=f[1],f[1]=null),null!==f[0]&&(l[s]=f[0]),null!==f[1]&&(m[s]=f[1]),X.has(s)&&t.push(s)}s&&t.length>0&&(r.style.willChange=t.join(", "));if(Object.keys(l).length>0){for(const e in l)r.style[e]=l[e];r.getBoundingClientRect()}if(Object.keys(m).length>0){r.style.transition=a.join(", "),r.getBoundingClientRect();for(const e in m)r.style[e]=m[e],h.add(e);r.addEventListener("transitionend",p),r.addEventListener("webkitTransitionEnd",p),u=window.setTimeout(f,1.1*g+200)}else f()}(),c;function f(){d||(window.clearTimeout(u),t&&t(),a(),m())}function p(e){r.style.willChange="",h.delete(e.propertyName),h.size<1&&f()}function m(){d||(window.clearTimeout(u),u=null,r.style.transition="",r.removeEventListener("transitionend",p),r.removeEventListener("webkitTransitionEnd",p),K.delete(o),h.clear(),l=null,t=null,a=null,d=!0)}}[["linear",[.25,.25,.75,.75]],["inSine",[.47,0,.745,.715]],["outSine",[.39,.575,.565,1]],["inOutSine",[.445,.05,.55,.95]],["inQuad",[.55,.085,.68,.53]],["outQuad",[.25,.46,.45,.94]],["inOutQuad",[.455,.03,.515,.955]],["inCubic",[.55,.055,.675,.19]],["outCubic",[.215,.61,.355,1]],["inOutCubic",[.645,.045,.355,1]],["inQuart",[.895,.03,.685,.22]],["outQuart",[.165,.84,.44,1]],["inOutQuart",[.77,0,.175,1]],["inQuint",[.755,.05,.855,.06]],["outQuint",[.23,1,.32,1]],["inOutQuint",[.86,0,.07,1]],["inExpo",[.95,.05,.795,.035]],["outExpo",[.19,1,.22,1]],["inOutExpo",[1,0,0,1]],["inCirc",[.6,.04,.98,.335]],["outCirc",[.075,.82,.165,1]],["inOutCirc",[.785,.135,.15,.86]]].forEach((e=>Y[e[0]]=`cubic-bezier(${e[1].join(",")})`));class G extends class{constructor(e={}){this._parent=null,this._collector={refs:[],components:[],pendingListeners:[],listeners:[]},this._storeListeners=[],this.refs={},this.state={},this.data={},this.props=e||{},this.base=null,this.mounted=!1,this.destroyed=!1,this.afterCreation(this.props,this.state),this.log=o(e.logName||this.constructor.name||"Component",e.logColor||"#fff",e.logBackground||"#0f3581",e.logDisable).log}storeSubscribe(e,t,n=this,s=!0){e.subscribe(t,n),this._storeListeners.push([e,t,n]),s&&t.call(n,e.current)}storeSubscribeOnce(e,t,n=this,s=!1){e.subscribeOnce(t,n),this._storeListeners.push([e,t,n]),s&&t.call(n,e.current)}afterCreation(){}template(){}beforeRender(){}afterRender(){}afterMount(){}beforeDestroy(){}ref(e){const t=this;return function(n){t.refs[e]=n}}refArray(e,t=!1){const n=this.refs[e]||(this.refs[e]=[]);let s,r,i=n.length;return t&&(s=this.refs.__pools||(this.refs.__pools={}),r=s[e]||(s[e]=[]),r.length&&(i=r.pop())),n[i]=null,function(e){n[i]=e,t&&r.push(i)}}refMap(e){const t={},n=this.refs[e]||(this.refs[e]=new Map);return function(e){e?n.set(t,e):n.delete(t)}}render(e,t){return C(e,t,this)}initHiding(){let e;return this.hiding=!0,this.hidePromise=new Promise((t=>e=t)),e}hide(){}show(){}unlistenToAll(){if(this._unlistened)return;this._unlistened=!0;let e=0;for(e=this._collector.listeners.length-1;e>=0;e--){const t=this._collector.listeners[e];"dom"===t.type?t.el.removeEventListener(t.evt,t.fn):"store"===t.type&&t.store.unsubscribe(t.fn)}for(e=this._storeListeners.length-1;e>=0;e--){const t=this._storeListeners[e];t[0].unsubscribe(t[1],t[2])}for(const t in this.state){const e=this.state[t];e&&e.destroy?e.destroy():e&&e.unsubscribeAll&&e.unsubscribeAll()}}destroy(){if(this.destroying)return;this.destroying=!0;let e=0;for(this.beforeDestroy(this.props,this.state),this.hidePromise=null,this.unlistenToAll(),e=this._collector.components.length-1;e>=0;e--)this._collector.components[e].destroy();if(this.mounted=!1,this.destroyed=!0,this._parent){const e=this._parent._collector.components.indexOf(this);~e&&this._parent._collector.components.splice(e,1),this._parent=null}for(e=this._collector.refs.length-1;e>=0;e--)this._collector.refs[e].fn(null),this._collector.refs.splice(e,1);let t=Array.isArray(this.base)?this.base:[this.base];for(e=0;e<t.length;e++)t[e]&&t[e].parentNode&&t[e].parentNode.removeChild(t[e]);this.base=t=null,this.props=null,this.state=null,this.data=null,this.refs=null,this._storeListeners=null}}{constructor(e){super(e),this.tweens={},this.tweenId=0}bind(e,t=0){return this[e]=function(e,t,n=0){if("string"==typeof e&&(e=t[e]),0===n)return function(){return e.call(t)};if(1===n)return function(n){return e.call(t,n)};if(2===n)return function(n,s){return e.call(t,n,s)};if(3===n)return function(n,s,r){return e.call(t,n,s,r)};if(4===n)return function(n,s,r,i){return e.call(t,n,s,r,i)};if(5===n)return function(n,s,r,i,o){return e.call(t,n,s,r,i,o)};throw new Error("Too many arguments")}(e,this,t),this[e]}csstween(e){return this.tweens[++this.tweenId]=J(e)}killAllCssTweens(){for(const e in this.tweens){const t=this.tweens[e];t&&t.destroy&&t.destroy()}this.tweens={}}destroy(){this.showPromise=null,this.hidePromise=null,this.killAllCssTweens(),super.destroy()}}const Z={png:"image/png",jpg:"image/jpg",json:"application/json",svg:"image/svg+xml",glb:"model/gltf-binary"};function ee(e){return Z[e]||"text/plain"}const te=function(){const e=1,t=2,n=3;return function(s){"string"==typeof s&&(s=function(e){const t=atob(e),n=t.length,s=new Uint8Array(n);for(let r=0;r<n;r++)s[r]=t.charCodeAt(r);return s.buffer}(s));const r=new DataView(s);let i,o,a=e,l=0,c=0;const h={width:r.getInt16(0,!0),height:r.getInt16(2,!0),frameDuration:r.getInt16(4,!0),frames:[]};for(let u=6,d=s.byteLength;u<d;u+=2)if(a===e)i={shapes:[]},h.frames.push(i),l=r.getInt16(u,!0),l>0&&(a=t);else if(a===t)o=[],i.shapes.push(o),c=r.getInt16(u,!0),c>0&&(a=n);else if(a===n){if(u+2>=d)break;const n=[r.getInt16(u,!0),r.getInt16(u+2,!0)];if(u+=2,o.push(n),--c>0)continue;a=--l>0?t:e}return h}}();const ne=function(e,t){t&&(e=e.bind(t));let n=!1,s=null,r=null,i=null;function o(){n=!1;const t=s,o=r,a=i;s=r=i=null,e(t,o,a)}return function(e,t,a){s=e,r=t,i=a,n||(n=!0,Promise.resolve().then(o).catch((e=>setTimeout((()=>{throw e}),0))))}}((()=>{V.frames.set(V.frames.current,!0)}));class se{constructor({reference:e}={}){this.reference=e||null,this.shapes=[],this.shapeIndex=-1}get pointCount(){let e=0;return this.shapes.forEach((t=>e+=t.length)),e}get shapePointCount(){return this.shapeIndex<0?0:this.shapes[this.shapeIndex].length}addShape(){if(this.shapeIndex>=0){if(this.shapes[this.shapeIndex].length<3)return}this.shapeIndex++,this.shapes.push([]),ne(),V.keyPressed.current.SHIFT=!1,V.keyPressed.set(V.keyPressed.current,!0)}removeShape(){this.shapeIndex<0||(this.shapes.pop(),this.shapeIndex--,ne())}removePoint(){if(this.shapeIndex<0)return;const e=this.shapes[this.shapeIndex];if(e.length<1)return this.removeShape(),void this.removePoint();e.pop(),ne(),e.length<1&&this.removeShape()}addPoint(e,t,n){const s=!!V.keyPressed.current.SHIFT,r=!!V.keyPressed.current.SPACE;if(!n&&r)return;(this.shapeIndex<0||!n&&s)&&this.addShape();this.shapes[this.shapeIndex].push([e,t]),ne()}}function re(e){return new Promise((t=>{if(!e)return t(null);let n=e.name.split(".");const s=n.pop();n=n.join(".");const r=new FileReader;r.onload=()=>{let e;try{"json"===s?e=JSON.parse(r.result):("vfx64"===s||"vfx"===s)&&(e=te(r.result));const i=e.width||10,o=e.height||10,a=e.frameDuration||30,l=function(e){if(!e.frames)throw new Error("Bad data");const t=[];return e.frames.forEach(((n,s)=>{const r=V.frames.current[s],i=new se({reference:r&&r.reference});t.push(i),n.shapes&&n.shapes.forEach((t=>{i.addShape(),t.forEach((t=>{const n=t[0]/e.width,s=t[1]/e.height;i.addPoint(n,s,!0)}))}))})),t}(e);return t({name:n,width:i,height:o,frameDuration:a,frames:l})}catch(i){return console.error(i),t(null)}},"json"===s||"vfx64"===s?r.readAsText(e):"vfx"===s?r.readAsArrayBuffer(e):t(null)}))}class ie extends G{template(){return t("div",{class:"import-zone"},t("input",{type:"file",onChange:e=>this.onChange(e),accept:".json,.vfx,.vfx64,.jpg,.png,.gif",multiple:!0}),t("div",{class:"content"},t("p",null,"↳ Drag or click to import images and vfx files")))}async importImages(e){let t="";const n=[];let s={};for(let r=0;r<e.length;r++){const i=e[r],o=ee(i.name.split(".").pop());if(!o.startsWith("image"))continue;const a=i.name.match(/^(.*[^0-9])([0-9]+)?\.([a-z]{2,4})$/i);a?n.push(new Promise((e=>{const n=a[2]||0;t=a[1].trim();const r=new FileReader,l=document.createElement("img");l.onload=()=>e(s[n]=l),r.onload=()=>{const e=new Blob([r.result]);l.src=URL.createObjectURL(e,o)},r.readAsArrayBuffer(i)}))):console.warn(`${i.name} cannot be used. Please use image with a naming like Image001.png`)}await Promise.all(n),s=Object.keys(s).sort().map((e=>s[e])),s.length&&(V.sourceName.set(t),V.sourceWidth.set(s[0].naturalWidth),V.sourceHeight.set(s[0].naturalHeight),V.frames.set(s.map((e=>new se({reference:e})))))}async importData(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=n.name.split(".").pop();"json"!==s&&"vfx"!==s&&"vfx64"!==s||t.push(re(n))}let n=await Promise.all(t);if(n=n.filter(Boolean),!n)return;const s=n[n.length-1];void 0!==s.name&&V.sourceName.set(s.name),s.width&&V.sourceWidth.set(s.width),s.height&&V.sourceHeight.set(s.height),s.frameDuration&&V.frameDuration.set(s.frameDuration),s.frames&&V.frames.set(s.frames)}async onChange(e){const t=e.target.files;try{j(),await this.importImages(t),await this.importData(t)}finally{U()}}}const oe=({key:e,text:n})=>t("li",{class:"shortcut"},t("figure",{textContent:e}),t("span",{textContent:n}));class ae extends G{beforeRender(e,t){}template(e,n){return t("section",{class:"editor-shortcuts","class-visible":V.helpVisible},t("ul",null,t(oe,{key:"H",text:"Display shortcuts"}),t(oe,{key:"Enter",text:"Preview vfx"}),t(oe,{key:"S",text:"Export vfx"}),t(oe,{key:"B",text:"Export vfx as base64"}),t(oe,{key:"Space + Mouse",text:"Pan and zoom workspace"}),t(oe,{key:"Shift + Space",text:"Reset zoom and space"}),t(oe,{key:"← →",text:"Previous / next frame"}),t(oe,{key:"Backspace / Z",text:"Remove last point"}),t(oe,{key:"Shift + Click",text:"Start a new shape"}),t(oe,{key:"W",text:"Toggle wireframe mode"}),t(oe,{key:"N",text:"Toggle night mode"}),t(oe,{key:"C / V",text:"Copy / Paste current frame data"})))}}class le extends G{template({value:e}){return t("input",{class:this.props.validation,value:e,onKeyDown:this.bind("keydown",1),onBlur:this.bind("submit",1)})}keydown(e){const t=this.props.validation;"Enter"===e.key?e.target.blur():"number"===t&&"ArrowDown"===e.key?(e.preventDefault(),this.updateValue(this.props.value.current-1)):"number"===t&&"ArrowUp"===e.key&&(e.preventDefault(),this.updateValue(this.props.value.current+1))}updateValue(e){const t=this.props.validation,n=this.base.value;if(e=e.toString(),"number"===t){const t=this.props.max||3e3,n=this.props.min||0;e=e.replace(/,/g,".").replace(/[^0-9.-]/g,""),e=isNaN(e)?e:+e,e=Math.min(t,Math.max(n,e))}else"name"===t&&(e=e.replace(/[^a-z0-9._-]/gi,""));n!==e&&(this.base.value=e),this.props.value.set(e)}submit(e){this.updateValue(e.target.value)}}const ce=({label:e,value:n,input:s,min:r,max:i,validation:o,classname:a})=>t("li",{class:"editor-info "+(a||"")},t("div",{class:"info-label",textContent:e}),s?t("div",{class:"info-value"},t(le,{value:s,min:r,max:i,validation:o})):t("div",{class:"info-value",textContent:n}));class he extends G{beforeRender(e,t){this.bind("submit",1),Object.assign(t,{resolution:H([V.sourceWidth,V.sourceHeight],((e,t)=>e+" x "+t)),frame:H([V.frameIndex,V.framesCount],((e,t)=>e+1+" / "+t)),total:H([V.frame,V.frames],(e=>e?e.shapes.length+" / "+e.pointCount:"0 / 0"))})}template(e,{frame:n,total:s}){return t("section",{class:"editor-infos"},t("ul",null,t(ce,{classname:"input",label:"Name",input:V.sourceName,validation:"name"}),t(ce,{label:"Width",input:V.sourceWidth,validation:"number"}),t(ce,{label:"Height",input:V.sourceHeight,validation:"number"}),t(ce,{label:"Frame duration",min:10,input:V.frameDuration,validation:"number"}),t(ce,{classname:"frame",label:"Current Frame",value:n}),t(ce,{classname:"frame",label:"Shapes / Points",value:s})))}}class ue extends G{template(){return t("div",{class:"canvas-preview"})}afterMount(){this.storeSubscribe(V.frame,this.onFrameChange)}onFrameChange(e){this.img&&this.img.parentNode&&this.img.parentNode.removeChild(this.img),e&&e.reference&&(this.img=e.reference,this.base.appendChild(this.img))}}const de=2*Math.PI,fe={x:0,y:0};class pe extends G{template(){return t("div",{class:"canvas-renderer"},t("canvas",{ref:this.ref("canvas")}))}afterMount(){this.mousePos={x:0,y:0},this.needsUpdate=!0,this.canvas=this.refs.canvas,this.ctx=this.canvas.getContext("2d"),this.storeSubscribe(V.canvasSize,this.resize),this.storeSubscribe(V.screenPixelRatio,this.resize),this.storeSubscribe(V.frame,(()=>this.needsUpdate=!0)),this.storeSubscribe(V.frames,(()=>this.needsUpdate=!0)),this.storeSubscribe(V.nightMode,(()=>this.needsUpdate=!0)),this.storeSubscribe(V.wireframeMode,(()=>this.needsUpdate=!0)),this.storeSubscribe(V.keyPressed,(()=>this.needsUpdate=!0)),this.storeSubscribe(V.tick,this.render)}beforeDestroy(){this.canvas=this.ctx=null}resize(){const e=V.canvasSize.current,t=V.screenPixelRatio.current;this.canvas.width=e[0]*t,this.canvas.height=e[1]*t,this.canvas.style.width=e[0]+"px",this.canvas.style.height=e[1]+"px",this.needsUpdate=!0}getPosition(e,t=fe){const n=this.refs.canvas.getBoundingClientRect(),s=e.clientX-n.x,r=e.clientY-n.y;return t.x=s/n.width,t.y=r/n.height,t}onMouseMove(e){this.getPosition(e,this.mousePos),this.needsUpdate=!0}onClick(e){const t=this.getPosition(e),n=t.x,s=t.y,r=V.frame.current;r&&r.addPoint(n,s)}render(e){if(!this.needsUpdate)return;this.needsUpdate=!1;const t=!!V.keyPressed.current.SHIFT,n=!!V.keyPressed.current.SPACE,s=V.frame.current,r=this.ctx,i=this.canvas.width,o=this.canvas.height,a=V.screenPixelRatio.current;if(r.clearRect(0,0,i,o),r.fillStyle=V.nightMode.current?"#ffffff":"#000000",r.strokeStyle=V.nightMode.current?"#ffffff":"#000000",r.lineWidth=a,!s)return;let l=!1,c=0,h=0;for(let d=0,f=s.shapes.length;d<f;d++){const e=d+1===f&&!t,n=s.shapes[d];if(l=!1,0!==n.length)if(n.length>1){r.beginPath();for(let e=0;e<n.length;e++){const t=n[e],s=Math.round(t[0]*i),a=Math.round(t[1]*o);0===e?r.moveTo(s,a):r.lineTo(s,a),l=!0,c=s,h=a}const t=V.wireframeMode.current||n.length<3;t&&e||r.closePath(),t?r.stroke():r.fill()}else if(1===n.length){const e=Math.round(n[0][0]*i),t=Math.round(n[0][1]*o);r.beginPath(),r.arc(e,t,a/2,0,de),r.fill(),l=!0,c=e,h=t}}const u=s?s.shapePointCount:0;l&&!n&&(u<3||!t)?(r.strokeStyle=V.nightMode.current?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)",r.beginPath(),r.moveTo(c,h),r.lineTo(Math.round(this.mousePos.x*i),Math.round(this.mousePos.y*o)),r.stroke()):l&&!t||(r.beginPath(),r.arc(Math.round(this.mousePos.x*i),Math.round(this.mousePos.y*o),a/2,0,de),r.fill())}}class me extends G{template(){return t("section",{class:"editor-canvas",onMouseMove:this.bind("onMouseMove",1),onClick:this.bind("onClick",1)},t("div",{class:"canvas-wrapper",ref:this.ref("wrapper")},t(ue,null),t(pe,{ref:this.ref("renderer")})))}afterRender(){this.storeSubscribe(V.canvasSize,this.onResize),this.storeSubscribe(V.zoomOffset,this.move),this.storeSubscribe(V.panOffset,this.move)}onResize(e){this.refs.wrapper.style.width=e[0]+"px",this.refs.wrapper.style.height=e[1]+"px"}onMouseMove(e){this.refs.renderer&&this.refs.renderer.onMouseMove(e)}onClick(e){this.refs.renderer&&this.refs.renderer.onClick(e)}move(){const e=Math.pow(2,V.zoomOffset.current),t=V.panOffset.current,n=t[0],s=t[1];this.refs.wrapper.style.transform=["scale("+e+")","translate("+n+"px, "+s+"px)"].join(" ")}}const ge=[],we=new Set;let be=16.67,ve=performance.now(),ye=!1,xe=-1,Se=!1;const Pe=e=>e.render(be),Ce={width:1,height:1,frameDuration:33,frames:[]};let ke=20,Ae=20;function _e({maxPool:e=20,initialPool:t=20}={}){if(!ye){ke=e,Ae=t,ye=!0;for(let e=0;e<Ae;e++)ge.push(new Me)}}function Ee(){xe=requestAnimationFrame(Ee);const e=performance.now();be=e-ve,ve=e,we.forEach(Pe)}function De(e={}){ye||_e(),Se||(Se=!0,xe=requestAnimationFrame(Ee));const t=ge.pop()||new Me;return we.add(t),t.reset(e),t}class Me{constructor(){this.frameDuration=33,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.canvas.height=0,this.canvas.style.pointerEvents="none",this.canvas.style.display="block"}reset(e={}){this.destroyed=!1,this.data=e.data||Ce,this.naturalWidth=this.data.width||1,this.naturalHeight=this.data.height||1,this.frames=this.data.frames||[],this.framecount=0|this.frames.length,this.frameDuration=e.frameDuration||this.data.frameDuration||Ce.frameDuration,this.onComplete=e.onComplete,this.delay=0|e.delay,this.loop=!!e.loop,this.dpi=e.dpi||Math.min(e.maxDpi||2,window.devicePixelRatio),this.width=Math.round((e.width||e.size||this.naturalWidth)*this.dpi),this.height=Math.round(e.height?e.height*this.dpi:this.width*(this.naturalHeight/this.naturalWidth));const t=this.canvas.style;this.widthRatio=this.width/this.naturalWidth,this.heightRatio=this.height/this.naturalHeight,this.canvas.width=this.width,this.canvas.height=this.height,t.width=Math.round(this.width/this.dpi)+"px",t.height=Math.round(this.height/this.dpi)+"px",this.ctx.fillStyle=e.color?e.color:"#ffffff",this.ctx.strokeStyle=e.color?e.color:"#ffffff",e.parent?(t.position="",t.zIndex="",e.parent.appendChild(this.canvas)):(t.position="fixed",t.zIndex=e.z||99999,document.body.appendChild(this.canvas)),this.x=e.x||0,this.y=e.y||0,this.ang=e.ang||0,t.transform=`translate(${this.x}px, ${this.y}px) rotate(${this.ang}deg)`,this.currentFrame=-1,this.accum=this.frameDuration}render(e){if(this.destroyed)return;if(this.delay>0&&(this.delay-=e)>0)return;if(this.accum+=e,this.accum<this.frameDuration)return;if(this.accum=this.accum%this.frameDuration,this.currentFrame++,this.currentFrame>=this.framecount){if(!this.loop)return this.destroy();this.currentFrame=0}const t=this.ctx,n=this.frames[this.currentFrame];if(t.clearRect(0,0,this.width,this.height),n)for(let s=0,r=n.shapes.length;s<r;s++){const e=n.shapes[s];if(e.length>2){t.beginPath();for(let n=0;n<e.length;n++){const s=e[n],r=s[0]*this.widthRatio,i=s[1]*this.heightRatio;0===n?t.moveTo(r,i):t.lineTo(r,i)}t.closePath(),t.fill()}}}destroy(){if(this.destroyed)return;this.destroyed=!0,this.data=null,this.canvas.width=this.canvas.height=0,we.delete(this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);const e=this.onComplete;this.onComplete=null,ge.length<ke&&ge.push(this),e&&e(),we.size<1&&Se&&(Se=!1,cancelAnimationFrame(xe))}}var Ie={init:_e,create:De,play:De,decode:te};class Re extends G{beforeRender(e,t){Object.assign(t,{visible:H(V.previewData,(e=>!!e))})}template(e,{visible:n}){return t("section",{class:"editor-preview","class-visible":n},t("div",{class:"preview-wrapper",ref:this.ref("wrapper")}))}afterMount(){this.storeSubscribe(V.previewData,this.onPreview)}onPreview(e){if(this.vfx&&this.vfx.destroy(),this.vfx=null,!e)return;const t=Ie.decode(e);this.vfx=Ie.create({data:t,loop:!0,parent:this.refs.wrapper,color:V.nightMode.current?"#ffffff":"#000000",size:400})}beforeDestroy(){this.vfx&&this.vfx.destroy(),this.vfx=null}}function Le(e,t={}){const n=[];n.push(e.width),n.push(e.height),n.push(e.frameDuration||30);for(let i=0,o=e.frames.length;i<o;i++){const t=e.frames[i].shapes||[];n.push(t.length);for(let e=0,s=t.length;e<s;e++){const s=t[e];n.push(s.length);for(let e=0,t=s.length;e<t;e++){const t=s[e];n.push(t[0],t[1])}}}const s=new ArrayBuffer(2*n.length),r=new DataView(s);for(let i=0,o=n.length;i<o;i++)r.setInt16(2*i,parseInt(n[i]),!0);return t.base64?function(e){let t="";const n=new Uint8Array(e),s=n.byteLength;for(let r=0;r<s;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}(s):new Blob([s],{type:"application/octet-stream"})}window.encode=Le;const ze=["ARROWRIGHT","ARROWLEFT","BACKSPACE","Z"],Oe={ENTER:"previewVfx",H:"toggleHelp",S:"exportVfx",B:"exportVfx64",W:"toggleWireframe",N:"toggleNightMode",Z:"removePoint",ARROWRIGHT:"nextFrame",ARROWLEFT:"previousFrame",BACKSPACE:"removePoint",SPACE:"resetWorkspace",SHIFT:"noop",ALT:"noop",C:"copyFrame",V:"pasteFrame"},Te=document.createElement("a");Object.assign(Te.style,{position:"fixed",width:"1px",height:"1px",top:0,left:0,opacity:.5,overflow:"hidden"});class Ne extends G{noop(){}template(){return t("section",{class:"editor"},t(he,null),t(ae,null),t(me,null),t(Re,null))}afterRender(){this.pointerX=0,this.pointerY=0,this.keysDown={},this.bind("onImportVfx",1),this.bind("resizePoints"),this.prevWidth=V.sourceWidth.current,this.prevHeight=V.sourceHeight.current,this.storeSubscribe(V.sourceWidth,this.resizePoints,this,!1),this.storeSubscribe(V.sourceHeight,this.resizePoints,this,!1),window.addEventListener("keydown",this.bind("onKeyDown",1)),window.addEventListener("keyup",this.bind("onKeyUp",1)),window.addEventListener("mousewheel",this.bind("onWheel",1)),window.addEventListener("pointerdown",this.bind("onPointerDown",1)),window.addEventListener("pointerup",this.bind("onPointerUp",1)),window.addEventListener("pointerup",this.bind("onPointerUp",1)),window.addEventListener("pointermove",this.bind("onPointerMove",1))}beforeDestroy(){window.removeEventListener("mousewheel",this.onWheel),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("pointermove",this.onPointerMove)}resizePoints(){const e=V.sourceWidth.current,t=V.sourceHeight.current,n=(e-this.prevWidth)/e*.5,s=this.prevWidth/e,r=(t-this.prevHeight)/t*.5,i=this.prevHeight/t,o=V.frames.current;o&&o.forEach((e=>{const t=e.shapes;t&&t.forEach((e=>{e.forEach((e=>{e[0]=e[0]*s+n,e[1]=e[1]*i+r}))}))})),this.prevWidth=e,this.prevHeight=t}onPointerDown(e){this.pointerX=e.screenX,this.pointerY=e.screenY,V.pointerDown.set(!0)}onPointerUp(){V.pointerDown.set(!1)}onPointerMove(e){if(!V.grabbing.current)return;const t=V.panOffset.current,n=Math.pow(2,V.zoomOffset.current);t[0]+=(e.screenX-this.pointerX)/n,t[1]+=(e.screenY-this.pointerY)/n,this.pointerX=e.screenX,this.pointerY=e.screenY,V.panOffset.set(t,!0)}onWheel(e){if(!V.keyPressed.current.SPACE)return;const t=-e.deltaY/300;V.zoomOffset.set(V.zoomOffset.current+t)}resetWorkspace(){if(!V.keyPressed.current.SHIFT)return;V.zoomOffset.set(0);const e=V.panOffset.current;e[0]=0,e[1]=0,V.panOffset.set(e,!0)}onKeyDown(e){const t=e.target.tagName;if("INPUT"===t||"TEXTAREA"===t)return;const n=" "===e.key?"SPACE":e.key.toUpperCase();Oe[n]&&!this.keysDown[n]&&(ze.includes(n)||(this.keysDown[n]=!0),V.keyPressed.set(this.keysDown,!0),this[Oe[n]]())}onKeyUp(e){const t=e.target.tagName;if("INPUT"===t||"TEXTAREA"===t)return;const n=" "===e.key?"SPACE":e.key.toUpperCase();Oe[n]&&(this.keysDown[n]=!1,V.keyPressed.set(this.keysDown,!0))}previewVfx(){const e=Le(this.getData(),{base64:!0});V.previewData.set(V.previewData.current?null:e)}toggleHelp(){V.helpVisible.set(!V.helpVisible.current)}exportVfx(){const e=Le(this.getData()),t=URL.createObjectURL(e),n=V.sourceName.current;document.body.appendChild(Te),Te.setAttribute("href",t),Te.setAttribute("download",n+".vfx"),Te.click(),document.body.removeChild(Te)}exportVfx64(){const e=Le(this.getData(),{base64:!0}),t=V.sourceName.current,n="data:text/plain;charset=utf-8,"+encodeURIComponent(e);document.body.appendChild(Te),Te.setAttribute("href",n),Te.setAttribute("download",t+".vfx64"),Te.click(),document.body.removeChild(Te)}toggleNightMode(){V.nightMode.set(!V.nightMode.current)}previousFrame(){V.frameIndex.current<=0||V.frameIndex.set(V.frameIndex.current-1)}nextFrame(){const e=V.frames.current.length-1;V.frameIndex.current>=e||V.frameIndex.set(V.frameIndex.current+1)}removePoint(){const e=V.frame.current;e&&e.removePoint()}getData(){const e=V.sourceWidth.current,t=V.sourceHeight.current;return{width:e,height:t,frameDuration:V.frameDuration.current,frames:V.frames.current.map((n=>{const s=JSON.parse(JSON.stringify(n.shapes)),r=s.length;return r&&s[r-1].length<3&&s.pop(),s.forEach((n=>n.forEach((n=>{n[0]=Math.round(n[0]*e),n[1]=Math.round(n[1]*t)})))),{shapes:s}}))}}copyFrame(){const e=V.frame.current,t=JSON.stringify({isVfxFrame:!0,shapes:e.shapes,shapeIndex:e.shapeIndex});navigator.clipboard.writeText(t)}async pasteFrame(){try{const e=await navigator.clipboard.readText().then(JSON.parse);if(!e.isVfxFrame)return;const t=e.shapes,n=e.shapeIndex,s=V.frame.current;s.shapes=t,s.shapeIndex=n}catch(e){}}toggleWireframe(){V.wireframeMode.set(!V.wireframeMode.current)}}class Fe extends G{template(){return t("aside",{class:"logo"},t("figure",null,t("span",null,"Ⓥ"),t("span",null,"Ⓕ"),t("span",null,"Ⓧ")))}}const We=document.documentElement;class He extends G{template(){return t("main",{class:"app"},t(Fe,null))}afterRender(){this.storeSubscribe(V.sourceName,this.changeCurrentView),this.storeSubscribe(V.framesCount,(()=>{V.frameIndex.set(0)})),this.storeSubscribe(V.nightMode,(e=>{We.classList.toggle("nightmode",!!e)})),this.storeSubscribe(V.panning,(e=>{We.classList.toggle("panning",!!e)})),this.storeSubscribe(V.grabbing,(e=>{We.classList.toggle("grabbing",!!e)})),this.storeSubscribe(V.keyPressed,(e=>{const t=V.frame.current,n=t?t.shapePointCount:0;We.classList.toggle("shift",!!e.SHIFT&&n>=3)}))}changeCurrentView(e){this.refs.currentView&&this.refs.currentView.destroy();const n=e&&e.length?Ne:ie;this.render(t(n,{ref:this.ref("currentView")}),this.base)}}const je={trailing:!0,leading:!0},Ue=document.documentElement;let Ve;function Be(e=!1){document.body.appendChild(Ve);const t=Ve.getBoundingClientRect();document.body.removeChild(Ve);const n=window.innerWidth,s=t.height,r=V.viewportSize.current;(e||n!==r[0]||s!==r[1])&&(r[0]=n,r[1]=s,V.viewportRatio.set(n/s,!0),V.viewportSize.set(r,!0),Ue.style.setProperty("--inner-height",window.innerHeight+"px"))}function $e(){V.screenPixelRatio.current!==window.devicePixelRatio&&V.screenPixelRatio.set(window.devicePixelRatio||1)}var Ke={init:function(){Ve=document.createElement("div"),Ve.className="ruller",Object.assign(Ve.style,{position:"fixed",top:0,left:0,width:"1px",height:"100vh",pointerEvents:"none",userSelect:"none",zIndex:-1,opacity:0}),document.body.appendChild(Ve),setInterval($e,5e3),window.addEventListener("resize",e(Be,10,je),!1),Be(!0),$e(),setTimeout(Be,10),setTimeout(Be,150),setTimeout((()=>Be(!0)),500),V.triggerResize.subscribe(Be)},update:Be};const Xe="undefined"==typeof window?global:window,Qe=[],Ye=[],qe=[];let Je,Ge,Ze=null,et=null,tt=!1,nt=!1;function st(e){let t;if(void 0===e&&(e=0),null===et&&(et=e),Ge=e-et,Je+=Ge,et=e,Ze=tt?null:Xe.requestAnimationFrame(st),tt&&(tt=!1),nt){for(t=0;t<qe.length;t++)qe[t](Ge);for(t=0;t<Qe.length;t++)Qe[t](Ge);for(t=0;t<Ye.length;t++)Ye[t](Ge)}else for(t=0;t<Qe.length;t++)Qe[t](Ge)}function rt(){nt=!!(Ye.length>0||qe.length>0)}function it(e,t,n){return!(!t||!e)&&(!~e.indexOf(t)&&((n=!!n)?e.unshift(t):e.push(t),!0))}function ot(e,t){if(!t)return!1;const n=e.indexOf(t);return!!~n&&(e.splice(n,1),!(0!==e.length))}function at(e){tt=!1,Ze||(et=null,(e=!!e)?st():Ze=Xe.requestAnimationFrame(st))}function lt(){Ze&&(Xe.cancelAnimationFrame(Ze),Ze=null)}var ct={add:function(e,t){it(Qe,e,t)&&at()},addAfter:function(e,t){it(Ye,e,t)&&rt()},addBefore:function(e,t){it(qe,e,t)&&rt()},remove:function(e){ot(Qe,e)&&lt()},removeAfter:function(e,t){ot(Ye,e)&&rt()},removeBefore:function(e){ot(qe,e)&&rt()},start:at,stop:lt,time:Je,dt:Ge,requestOnce:function(){Ze||(tt=!0,et=null,Ze=Xe.requestAnimationFrame(st))},dispose:function(){lt(),Qe.length=0,Ye.length=0,qe.length=0,nt=!1,et=null,Je=0,Ge=0}};let ht;var ut;Ke.init(),ct.add((e=>{V.tick.dispatch(e)})),ut=He,ht&&ht.destroy(),console.clear(),ht=C(t(ut.default||ut),document.body).components[0],V.initialized.set(!0);
